# Title: Potential Proot Exploits

# Creation date: 2023/03/07

# Category: Defense evasion

# Severity: Medium

# Description: Identifies the execution of the PRoot utility, an open-source tool for user-space implementation of
# chroot, mount --bind, and binfmt_misc. Adversaries can leverage an open-source tool PRoot
# to expand the scope of their operations to multiple Linux distributions and simplify their necessary efforts.
# In a normal threat scenario, the scope of an attack is limited by the varying configurations of each Linux distribution.
# With PRoot, it provides an attacker with a consistent operational environment across different Linux distributions,
# such as Ubuntu, Fedora, and Alpine. PRoot also provides emulation capabilities that allow for malware built on other
# architectures, such as ARM, to be run.The post-exploitation technique called bring your own filesystem (BYOF),
# can be used by the threat actors to execute malicious payload or elevate privileges or perform network scans or
# orchestrate another attack on the environment. Although PRoot was originally not developed with malicious intent
# it can be easily tuned to work for one.

# MITRE ATT&CK Tactic: TA0005 - Defense Evasion - https://attack.mitre.org/tactics/TA0005/

# MITRE ATT&CK Technique: T1211 - Exploitation for Defense Evasion - https://attack.mitre.org/techniques/T1211/

- name: Execution from proot
  type: Exec
  condition: header.image ENDS_WITH "/proot"