# Title: File Deletion Via Shred

# Creation date: 2020/04/27

# Category: Defense evasion

# Severity: Low

# Description: Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within
# a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or
# remove them at the end as part of the post-intrusion cleanup process.

# MITRE ATT&CK Tactic: TA0005 - Defense Evasion - https://attack.mitre.org/tactics/TA0005/

# MITRE ATT&CK Technique: T1070 - Indicator Removal - https://attack.mitre.org/techniques/T1070/

- name: Shred execution
  type: Exec
  condition: header.image == "/usr/bin/shred" AND (payload.argv CONTAINS "-u" OR payload.argv CONTAINS "--remove" OR payload.argv CONTAINS "-z" OR payload.argv CONTAINS "--zero")
