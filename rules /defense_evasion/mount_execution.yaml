# Title: Mount Execution

# Creation date: 2023/04/11

# Category: Defense evasion

# Severity: Medium

# Description: Identifies the execution of mount process with hidepid parameter, which can make processes invisible to
# other users from the system. Adversaries using Linux kernel version 3.2+ (or RHEL/CentOS v6.5+ above) can hide
# the process from other users. When hidepid=2 option is executed to mount the /proc filesystem, only the root user
# can see all processes and the logged-in user can only see their own process. This provides a defense evasion mechanism for
# the adversaries to hide their process executions from all other commands such as ps, top, pgrep and more.
# With the Linux kernel hardening hidepid option all the user has to do is remount the /proc filesystem with the option,
# which can now be monitored and detected.

# MITRE ATT&CK Tactic: TA0005 - Defense Evasion - https://attack.mitre.org/tactics/TA0005/

# MITRE ATT&CK Technique: T1564 - Hide Artifacts - https://attack.mitre.org/techniques/T1564/

- name: Mount proc with hidepid
  type: Exec
  condition: header.image == "/usr/bin/mount" 
    AND 
    (payload.argv CONTAINS "/proc" AND payload.argv CONTAINS "-o" AND payload.argv CONTAINS "hidepid=2")