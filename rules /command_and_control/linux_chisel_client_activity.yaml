# Title: Linux Chisel Client Activity

# Creation date: 2023/08/23

# Category: Command and control

# Severity: Medium

# Description: This rule monitors for common command line flags leveraged by the Chisel client utility followed by a connection attempt.
# Chisel is a command-line utility used for creating and managing TCP and UDP tunnels, enabling port forwarding and secure
# communication between machines. Attackers can abuse the Chisel utility to establish covert communication channels, bypass
# network restrictions, and carry out malicious activities by creating tunnels that allow unauthorized access to internal
# systems.

# MITRE ATT&CK Tactic: TA0011 - Command and Control - https://attack.mitre.org/tactics/TA0011/

# MITRE ATT&CK Technique: T1572 - Protocol Tunneling - https://attack.mitre.org/techniques/T1572/

- name: Shell executing suspicious binary with specific arguments
  type: Exec
  condition: payload.filename ENDS_WITH "client"
    AND 
    (payload.argv CONTAINS "R*" OR payload.argv CONTAINS "*:*" OR payload.argv CONTAINS "*socks*" OR payload.argv CONTAINS "*.*") 
    AND 
    payload.argc >= 4
    AND 
    (header.image ENDS_WITH "bash" OR header.image ENDS_WITH "dash" OR header.image ENDS_WITH "ash" OR header.image ENDS_WITH "sh" OR header.image ENDS_WITH "tcsh" OR header.image ENDS_WITH "csh" OR header.image ENDS_WITH "zsh" OR header.image ENDS_WITH "ksh" OR header.image ENDS_WITH "fish")


