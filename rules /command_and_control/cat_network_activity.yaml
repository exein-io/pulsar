# Title: Cat Network Activity

# Creation date: 2023/09/04

# Category: Command and control

# Severity: Medium

# Description: This rule monitors for the execution of the cat command, followed by a connection attempt by the same process. Cat 
# is capable of transfering data via tcp/udp channels by redirecting its read output to a /dev/tcp or /dev/udp channel. 
# This activity is highly suspicious, and should be investigated. Attackers may leverage this capability to transfer tools
# or files to another host in the network or exfiltrate data while attempting to evade detection in the process.

# MITRE ATT&CK Tactic: TA0011 - Command and Control - https://attack.mitre.org/tactics/TA0011/

# MITRE ATT&CK Technique:  -  - 

- name: Shell executing suspicious binary
  type: Exec
  condition: payload.filename ENDS_WITH "cat"
    AND 
    (header.image ENDS_WITH "/bash" OR header.image ENDS_WITH "/dash" OR header.image ENDS_WITH "/sh" OR header.image ENDS_WITH "/tcsh" 
    OR header.image ENDS_WITH "/csh" OR header.image ENDS_WITH "/zsh" OR header.image ENDS_WITH "/ksh" OR header.image ENDS_WITH "/fish")

    