# Title: Esxi Process Kill

# Creation date: 2023/04/11

# Category: Impact

# Severity: Medium

# Description: Identifies instances where VMware processes, such as "vmware-vmx" or "vmx," are terminated on a Linux system
# by a "kill" command. The rule monitors for the "end" event type, which signifies the termination of a process.
# The presence of a "kill" command as the parent process for terminating VMware processes may indicate that a
# threat actor is attempting to interfere with the virtualized environment on the targeted system.

# MITRE ATT&CK Tactic: TA0040 - Impact - https://attack.mitre.org/tactics/TA0040/

# MITRE ATT&CK Technique: T1489 - Service Stop - https://attack.mitre.org/techniques/T1489/

- name: Termination of VMware process by kill command
  type: Exec
  condition: header.image IN ["/usr/bin/kill", "/bin/kill"]
    AND payload.filename IN ["/usr/bin/vmware-vmx", "/usr/bin/vmx", "/bin/vmware-vmx", "/bin/vmx"]
 