# Title: Perl Tty Shell

# Creation date: 2020/04/16

# Category: Execution

# Severity: High

# Description: Identifies when a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully
# interactive tty after obtaining initial access to a host.

# MITRE ATT&CK Tactic: TA0002 - Execution - https://attack.mitre.org/tactics/TA0002/

# MITRE ATT&CK Technique: T1059 - Command and Scripting Interpreter - https://attack.mitre.org/techniques/T1059/

- name: Perl executing shell binary
  type: Exec
  condition: payload.filename == "/usr/bin/perl" AND payload.argv CONTAINS "exec" AND
    (payload.argv CONTAINS "/bin/sh" OR payload.argv CONTAINS "/bin/dash" OR payload.argv CONTAINS "/bin/bash")