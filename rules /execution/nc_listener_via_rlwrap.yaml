# Title: Nc Listener Via Rlwrap

# Creation date: 2023/09/22

# Category: Execution

# Severity: Low

# Description: Monitors for the execution of a netcat listener via rlwrap. rlwrap is a 'readline wrapper', a small utility that uses
# the GNU Readline library to allow the editing of keyboard input for any command. This utility can be used in conjunction 
# with netcat to gain a more stable reverse shell.

# MITRE ATT&CK Tactic: TA0002 - Execution - https://attack.mitre.org/tactics/TA0002/

# MITRE ATT&CK Technique: T1059 - Command and Scripting Interpreter - https://attack.mitre.org/techniques/T1059/

- name: Exec rlwrap with specific arguments
  type: Exec
  condition: payload.filename ENDS_WITH "/rlwrap" AND (payload.argv CONTAINS "nc" OR payload.argv CONTAINS "ncat" OR payload.argv CONTAINS "netcat" OR payload.argv CONTAINS "nc.openbsd" OR payload.argv CONTAINS "socat") AND payload.argv CONTAINS "*l*" AND payload.argc >= 4