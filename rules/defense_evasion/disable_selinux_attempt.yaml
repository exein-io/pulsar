# Title: Disable Selinux Attempt

# Creation date: 2020/04/22

# MITRE ATT&CK Tactic: TA0005 - Defense Evasion - https://attack.mitre.org/tactics/TA0005/

# MITRE ATT&CK Technique: T1562 - Impair Defenses - https://attack.mitre.org/techniques/T1562/

- name: Set enforce mode to permissive
  type: Exec
  category: defense_evasion
  severity: medium
  description: Detects potential attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to
    support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities.
  condition: payload.filename STARTS_WITH "/usr/sbin/setenforce" AND payload.argv CONTAINS "0"

- name: SELinux Configuration Creation or Renaming
  type: FileOpened
  category: defense_evasion
  severity: low
  description: Detects the creation or renaming of the SELinux configuration file. SELinux is a security module that
    provides access control security policies. Modifications to the SELinux configuration file may indicate an attempt to
    impair defenses by disabling or modifying security tools.
  condition: payload.filename STARTS_WITH "/etc/selinux/config" AND NOT header.image IN ["dockerd", "platform-python"]