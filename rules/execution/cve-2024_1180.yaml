# Title: CVE-2024-1180 - TP-Link Omada Command Injection

# Creation Date: 2025/04/17

# MITRE ATT&CK Tactic: TA0002 - Execution - https://attack.mitre.org/tactics/TA0002/

# MITRE ATT&CK Technique: T1203 - Exploitation for Client Execution - https://attack.mitre.org/techniques/T1203/

- name: CVE-2024-1180 - TP-Link Omada Command Injection
  type: Exec
  category: execution
  severity: medium
  description: Detects attempts to exploit CVE-2024-1180 by sending crafted POST requests to the TP-Link Omada web interface via curl or wget. 
    Attackers may use this to achieve command injection and remote code execution as root on the router.
  condition: (payload.filename ENDS_WITH "curl" OR payload.filename ENDS_WITH "wget")
    OR (header.image IN ["/usr/sbin/httpd", "www/cgi-bin/luci","/bin/busybox"]) 
    AND (
      (payload.argv CONTAINS "curl" AND payload.argv CONTAINS "-X" OR payload.argv CONTAINS "POST")
      OR (payload.argv CONTAINS "wget" AND payload.argv CONTAINS "--post-data")
    ) AND header.uid != 0
