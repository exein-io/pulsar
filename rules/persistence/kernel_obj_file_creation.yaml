# Title: Kernel Object File Creation

# Creation date: 2025/04/14

# MITRE ATT&CK Tactic: TA0003 - Persistence - https://attack.mitre.org/tactics/TA0003/

# MITRE ATT&CK Technique: T1547 - oot or Logon Autostart Execution - https://attack.mitre.org/techniques/T1147/

- name: Kernel Object File Creation
  type: FileCreated
  category: persistence
  severity: low
  description: Detects the creation of a Linux kernel object file (.ko) on a system. Threat actors may leverage Linux kernel
    object files to load a rootkit or other type of malware on a system providing them with complete control and the ability
    to hide from security products.
  condition: payload.filename ENDS_WITH "ko"
    AND NOT (
      (
        payload.filename STARTS_WITH "var/tmp/mkinitramfs_" OR
        header.image STARTS_WITH "/snap/" OR
        header.image ENDS_WITH "cpio"
      ) OR 
      payload.filename STARTS_WITH "/tmp/mkinitramfs"
    ) 