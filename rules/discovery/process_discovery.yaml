# Title: Process Discovery

# Creation Date: 2025/04/11

# MITRE ATT&CK Tactic: TA0007 - Discovery - https://attack.mitre.org/tactics/TA0007/

# MITRE ATT&CK Technique: T1082 - Process Discovery - https://attack.mitre.org/techniques/T1057/

- name: Process capability enumeration
  type: Exec
  category: discovery
  severity: low
  description: Detects recursive process capability enumeration of the entire filesystem through the getcap command. 
    Adversaries may manipulate identified capabilities to gain root privileges.
  condition: payload.filename ENDS_WITH "getcap" AND payload.argv CONTAINS "-r"
    AND header.uid != 0
