# Title: Potential Privilege Escalation via UID INT_MAX Bug 

# Creation Date: 2025/04/14

# MITRE ATT&CK Tactics TA0004 - Privilege Escalation - https://attack.mitre.org/tactics/TA0004/

# MITRE ATT&CK Technique T1068 - Exploitation for Privilege Escalation - https://attack.mitre.org/techniques/T1068/

- name: UID INT_MAX Bug Detected
  type: Exec
  category: privilege_escalation
  severity: medium
  description: Detects the execution of the systemd-run command by a user with a UID that is larger than the maximum
    allowed UID size (INT_MAX). Some older Linux versions were affected by a bug which allows user accounts with a UID
    greater than INT_MAX to escalate privileges by spawning a shell through systemd-run.
  condition: payload.filename ENDS_WITH "systemd-run" AND payload.argv CONTAINS "-L" AND payload.argc >= 3 AND
    header.uid >= 1000000000
