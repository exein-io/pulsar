# Title: Exploitation of nftables vulnerability (CVE-2024-1086)

# Creation Date: 2025/04/17

# MITRE ATT&CK Tactic: TA0004 - Privilege Escalation - https://attack.mitre.org/tactics/TA0004/

# MITRE ATT&CK Technique: T1068 - Exploitation for Privilege Escalation - https://attack.mitre.org/techniques/T1068/

- name: CVE-2024-1086 exploit, Use-After-Free via nftables
  type: Exec
  category: privilege_escalation
  severity: high
  description: Detects execution of the nft binary by non-root users, potentially exploiting CVE-2024-1086. 
    Adversaries may use this vulnerability to escalate privileges by manipulating nftables with unprivileged access.
  condition: payload.filename ENDS_WITH "/nft" AND payload.argv CONTAINS "add" AND payload.argv CONTAINS "rule" AND header.uid != 0
